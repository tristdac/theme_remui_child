"use strict";define(["jquery","theme_remui/bootstrap-select","core/templates","theme_remui/jquery-toolbar","core/ajax","core/notification"],function(e,t,a,s,r,n){var catid = $('#categoryid').attr('value');var i,o=e("select#sortfilter.selectpicker"),c=e("#coursesearch2"),l=e("select#categoryfilter.selectpicker"),d=e("#coursestab"),u=e("#mycoursestab"),p=e("#coursesregion div.content"),g=e("#mycoursesregion div.content"),v=e("#coursespagination"),h=e("#mycoursespagination"),m=e(".togglebtn"),b="theme_remui/course_card_grid",f="theme_remui/course_card_list",y=".page-header-actionss";function w(){i.isFilterModified&&function(){e(".courses-tabs .courses-loader-wrap").show();var t=i.tab?g:p,s=i.tab?h:v;r.call([{methodname:"theme_remui_get_courses",args:{data:JSON.stringify(i)}}])[0].done(function(r){r=JSON.parse(r),e(y).empty(),1==r.hasmanagebutton&&e(y).append(r.managebuttons),null!=r.dropdown?e("#page-header .page-header-actionss").append(r.dropdown):e('#page-header .page-header-actionss [data-enhance="moodle-core-actionmenu"]').remove();var o=null===i.view?r.view:i.view,c="grid"==o||r.latest_card?b:f;(window.screen.width<=480||r.latest_card)&&(c=b,o="grid"),"grid"==o?(i.view="grid",e(".tab-content").addClass("grid-view").removeClass("list-view"),e(".grid_btn").addClass("btn-primary active"),e(".list_btn").removeClass("btn-primary active")):(i.view="list",e(".tab-content").addClass("list-view").removeClass("grid-view"),e(".grid_btn").removeClass("btn-primary active"),e(".list_btn").addClass("btn-primary active")),r.latest_card?(e(".tab-content").addClass("latest-cards"),e(".viewtoggler").addClass("hidden")):(e(".tab-content").removeClass("latest-cards"),e(".viewtoggler").removeClass("hidden"));var l=r.courses;if(l.length>0)for(var d=0;d<l.length;d++)a.render(c,l[d]).then(function(s,n){a.appendNodeContents(t,s,n),i.tab||r.latest_card||e(".showoptions").each(function(){e(this).toolbar({content:e(this).data("toolbar"),style:"primary"})})}).fail(n.exception);else{'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button> No Courses Found</div>',a.appendNodeContents(t,'<div class="alert alert-warning alert-dismissible  w-full mx-10" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button> No Courses Found</div>',"")}i.pagination&&a.appendNodeContents(s,r.pagination,""),e(".courses-tabs .courses-loader-wrap").hide()}).fail(n.exception)}()}function C(){!function(){var t=i.tab?g:p;if(e(t).empty(),i.pagination){var a=i.tab?h:v;e(a).empty()}}(),w()}e(document).ready(function(){var t,a;(a={category:catid,sort:null,search:"",tab:!1,page:t={courses:0,mycourses:0},pagination:!0,view:null,isFilterModified:!0}).initAttributes=function(){a.category=catid,a.sort=null,a.search="",a.tab=!1,a.page=t,a.pagination=!0,a.view=null,a.isFilterModified=!0},a.initPagination=function(){a.page={courses:0,mycourses:0}},i=a;for(var s,r=[],n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++)s=n[o].split("="),r.push(s[0]),r[s[0]]=s[1];r.categoryid&&0!=r.categoryid&&(i.category=r.categoryid),null!=r.categorysort&&(i.sort=r.categorysort),null!=r.search&&(i.search=r.search),r.mycourses&&0!=r.mycourses&&(i.tab=!0,e("body").hasClass("notloggedin")&&(i.tab=!1)),function(t){e(".selectpicker").each(function(){e(this).selectpicker()}),"0"!==t.category&&e("#categoryfilter.selectpicker").selectpicker("val",t.category);null!==t.sort&&e("#sortfilter.selectpicker").selectpicker("val",t.sort);""!==t.sort&&e("#coursesearchbox").val(t.search);e(".category-filters").removeClass("d-none")}(i),w()}),e(document).delegate(".tool-item","click",function(){window.location=e(this).attr("href")}),e(l).on("changed.bs.select",function(e){i.category=e.target.value,i.initPagination(),C()}),e(o).on("changed.bs.select",function(e){i.sort=e.target.value,C()}),e(d).on("click",function(){i.tab=!1,C()}),e(u).on("click",function(){i.tab=!0,C()}),e(c).on("submit",function(t){t.preventDefault(),i.initPagination(),i.search=e("#coursesearchbox").val(),C()}),e(m).on("click",function(){var t=e(this).attr("data-view");i.view=t,M.util.set_user_preference("course_view_state",t,null),C()}),e(document).delegate(".tab-pane .pagination .page-item .page-link","click",function(e){e.preventDefault();var t=e.target.href;void 0===t&&void 0===(t=e.target.parentElement.href)&&(t=e.target.parentElement.parentElement.href);for(var a,s=t.slice(t.indexOf("?")+1).split("&"),r=[],n=0;n<s.length;n++)a=s[n].split("="),r.push(a[0]),r[a[0]]=a[1];i.tab?i.page.mycourses=r.page:i.page.courses=r.page,C()})});
//# sourceMappingURL=coursecategory.min.js.map
